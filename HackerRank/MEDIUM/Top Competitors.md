```sql
WITH LEADERBOARD AS ( 
SELECT H.HACKER_ID, 
       H.NAME,
       COUNT(C.CHALLENGE_ID) AS NUMBER_OF_CHALLENGE,
       D.DIFFICULTY_LEVEL,
       MAX(S.SCORE) AS SCORE
FROM HACKERS H
JOIN 
    CHALLENGES C ON H.HACKER_ID = C.HACKER_ID
JOIN 
    DIFFICULTY D ON C.DIFFICULTY_LEVEL = D.DIFFICULTY_LEVEL
JOIN 
    SUBMISSIONS S ON H.HACKER_ID = S.HACKER_ID
WHERE S.SCORE >= D.SCORE
GROUP BY H.HACKER_ID, H.NAME,D.DIFFICULTY_LEVEL
HAVING COUNT( C.CHALLENGE_ID) > 1 
)

SELECT HACKER_ID, NAME
FROM LEADERBOARD
ORDER BY NUMBER_OF_CHALLENGE DESC,
```
